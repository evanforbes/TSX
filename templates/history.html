<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>Scan History - Auction House</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            background: #000; color: #fff;
            padding-top: env(safe-area-inset-top);
            padding-bottom: calc(20px + env(safe-area-inset-bottom));
        }
        a { color: inherit; text-decoration: none; }
        .header {
            background: #000; padding: 16px 20px;
            display: flex; align-items: center; gap: 16px;
            border-bottom: 1px solid #222; position: sticky; top: 0;
        }
        .back-btn { color: #0A84FF; font-size: 17px; }
        .header h1 { font-size: 20px; font-weight: 700; }
        .card {
            background: #111; margin: 16px; border-radius: 16px; overflow: hidden;
        }
        .history-item {
            padding: 16px 20px; border-bottom: 1px solid #1c1c1c;
        }
        .history-item:last-child { border-bottom: none; }
        .history-date {
            font-size: 15px; font-weight: 600; margin-bottom: 12px;
        }
        .history-stats {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
        }
        .stat {
            background: #1c1c1e; padding: 10px; border-radius: 8px; text-align: center;
        }
        .stat-value { font-size: 20px; font-weight: 700; }
        .stat-value.gold { color: #FFD60A; }
        .stat-value.silver { color: #98989D; }
        .stat-value.buy { color: #00C805; }
        .stat-value.sell { color: #FF3B30; }
        .stat-label { font-size: 10px; color: #8E8E93; text-transform: uppercase; margin-top: 4px; }
        .symbols-row {
            margin-top: 12px; font-size: 13px; color: #8E8E93;
        }
        .symbols-row .symbol { color: #0A84FF; margin-right: 8px; }
        .empty-state {
            text-align: center; padding: 60px 20px; color: #666;
        }
        .empty-state .title { font-size: 18px; font-weight: 600; color: #fff; margin-bottom: 8px; }
    </style>
</head>
<body>
    <div class="header">
        <a href="/" class="back-btn">‚Üê Back</a>
        <h1>Scan History</h1>
    </div>

    {% if history %}
    <div class="card">
        {% for scan in history %}
        <div class="history-item">
            <div class="history-date">{{ scan.timestamp[:16].replace('T', ' ') }}</div>
            <div class="history-stats">
                <div class="stat">
                    <div class="stat-value gold">{{ scan.summary.gold_buys + scan.summary.gold_sells }}</div>
                    <div class="stat-label">Gold</div>
                </div>
                <div class="stat">
                    <div class="stat-value silver">{{ scan.summary.silver_buys + scan.summary.silver_sells }}</div>
                    <div class="stat-label">Silver</div>
                </div>
                <div class="stat">
                    <div class="stat-value">{{ scan.total_signals }}</div>
                    <div class="stat-label">Total</div>
                </div>
            </div>
            {% if scan.gold_buys or scan.gold_sells %}
            <div class="symbols-row">
                <strong>Gold:</strong>
                {% for sym in scan.gold_buys %}
                <span class="symbol">{{ sym }}</span>
                {% endfor %}
                {% for sym in scan.gold_sells %}
                <span class="symbol">{{ sym }}</span>
                {% endfor %}
            </div>
            {% endif %}
            {% if scan.silver_buys or scan.silver_sells %}
            <div class="symbols-row">
                <strong>Silver:</strong>
                {% for sym in scan.silver_buys[:5] %}
                <span class="symbol">{{ sym }}</span>
                {% endfor %}
                {% for sym in scan.silver_sells[:5] %}
                <span class="symbol">{{ sym }}</span>
                {% endfor %}
                {% if (scan.silver_buys|length + scan.silver_sells|length) > 10 %}
                <span>+{{ (scan.silver_buys|length + scan.silver_sells|length) - 10 }} more</span>
                {% endif %}
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <div class="title">No scan history</div>
        <div>Run a scan to see history</div>
    </div>
    {% endif %}
</body>
</html>
